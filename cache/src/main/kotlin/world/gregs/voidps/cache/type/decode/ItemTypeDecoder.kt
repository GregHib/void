package world.gregs.voidps.cache.type.decode

import world.gregs.voidps.cache.type.TypeDecoder
import world.gregs.voidps.cache.type.types.ItemType

class ItemTypeDecoder(size: Int) : TypeDecoder<ItemType>(size) {
    // Custom values
    override val id = int("id", default = -1, opcode = 250)
    override val stringId = string("[section]", default = "", opcode = 251)
    // Original values
    val modelId = ushort("model_id", default = 0, opcode = 1)
    val name = string("name", default = "null", opcode = 2)
    val spriteScale = short("sprite_scale", default = 2000, opcode = 4)
    val spritePitch = short("sprite_pitch", default = 0, opcode = 5)
    val spriteCameraRoll = short("sprite_camera_roll", default = 0, opcode = 6)
    val spriteTranslateX = short("sprite_translate_x", default = 0, opcode = 7)
    val spriteTranslateY = short("sprite_translate_y", default = 0, opcode = 8)
    val stackable = int("stackable", default = 0, literal = 1, opcode = 11)
    val cost = int("cost", default = 1, opcode = 12)
    val members = bool("members", default = false, literal = true, opcode = 16)
    val multiStackSize = short("multi_stack_size", default = -1, opcode = 18)
    val primaryMaleModel = ushort("primary_male_model", default = -1, opcode = 23)
    val secondaryMaleModel = ushort("secondary_male_model", default = -1, opcode = 24)
    val primaryFemaleModel = ushort("primary_female_model", default = -1, opcode = 25)
    val secondaryFemaleModel = ushort("secondary_female_model", default = -1, opcode = 26)
    val floorOptions = indexedStringArray("floor_options", default = arrayOf(null, null, "Take", null, null, "Examine"), opcodes = 30..34)
    val options = indexedStringArray("options", default = arrayOf(null, null, null, null, "Drop"), opcodes = 35..39)
    val colours = shortArrays("original_colours", "modified_colours", opcode = 40)
    val textureColours = shortArrays("original_texture_colours", "modified_texture_colours", opcode = 41)
    val recolourPalette = byteArray("recolour_palette", opcode = 42)
    val exchangeable = bool("exchangeable", default = false, literal = true, opcode = 65)
    val tertiaryMaleModel = short("tertiary_male_model", default = -1, opcode = 78)
    val tertiaryFemaleModel = short("tertiary_female_model", default = -1, opcode = 79)
    val primaryMaleDialogueHead = short("primary_male_dialogue_head", default = -1, opcode = 90)
    val primaryFemaleDialogueHead = short("secondary_male_dialogue_head", default = -1, opcode = 91)
    val secondaryMaleDialogueHead = short("primary_female_dialogue_head", default = -1, opcode = 92)
    val secondaryFemaleDialogueHead = short("secondary_female_dialogue_head", default = -1, opcode = 93)
    val spriteCameraYaw = short("sprite_camera_yaw", default = 0, opcode = 95)
    val dummyItem = ubyte("dummy_item", default = 0, opcode = 96)
    val noteId = short("note_id", default = -1, opcode = 97)
    val notedTemplateId = short("noted_template_id", default = -1, opcode = 98)
    val stack = stacks("stack_ids", "stack_amounts", opcodes = 100..109)
    val floorScaleX = short("floor_scale_x", default = 128, opcode = 110)
    val floorScaleY = short("floor_scale_y", default = 128, opcode = 111)
    val floorScaleZ = short("floor_scale_z", default = 128, opcode = 112)
    val ambience = byte("ambience", default = 0, opcode = 113)
    val diffusion = byte("diffusion", default = 0, opcode = 114)
    val team = ubyte("team", default = 0, opcode = 115)
    val lendId = short("lend_id", default = -1, opcode = 121)
    val lendTemplateId = short("lend_template_id", default = -1, opcode = 122)
    val maleWield = triple(byte("male_wield_x", default = 0), byte("male_wield_y", default = 0), byte("male_wield_z", default = 0), opcode = 125)
    val femaleWield = triple(byte("female_wield_x", default = 0), byte("female_wield_y", default = 0), byte("female_wield_z", default = 0), opcode = 126)
    val primaryCursor = pair(ubyte("primary_cursor_opcode", default = -1), short("primary_cursor", default = -1), opcode = 127)
    val secondaryCursor = pair(ubyte("secondary_cursor_opcode", default = -1), short("secondary_cursor", default = -1), opcode = 128)
    val primaryInterfaceCursor = pair(ubyte("primary_interface_cursor_opcode", default = -1), short("primary_interface_cursor", default = -1), opcode = 129)
    val secondaryInterfaceCursor = pair(ubyte("secondary_interface_cursor_opcode", default = -1), short("secondary_interface_cursor", default = -1), opcode = 130)
    val campaigns = shortArray("campaigns", opcode = 132)
    val pickSizeShift = ubyte("pick_size_shift", default = 0, opcode = 134)
    val singleNoteId = short("single_note_id", default = -1, opcode = 139)
    val singleNoteTemplateId = short("single_note_template_id", default = -1, opcode = 140)
    val parameters = params(opcode = 249) {
        add("tradeable", "weight", "slot", "examine", "kept", "destroy", "destroy2", "destroy3", "destroy4", "clone", "material", "charges", "charge")
        add("aka", "fletchables", "items")
        add("bank_stacks", "limit", "price", "rank", "canoe_chance_min", "canoe_chance_max", "transform_experience", "use_experience")
        add("skill_req", "npc", "npc2", "food", "food2", "npc3", "heals", "eat_message")
        add("degrade", "deplete", "charges_max", "degrade_message")
        add("special_points", "summon_experience", "infuse_experience")
        add("mining_delay", "smelting", "summoning_def", "pottery", "firemaking", "cleaning", "mining", "smithing", "fishing", "fletching_unf", "fletch_dart", "weaving", "fletch_bolts", "spinning", "cooking", "runecrafting")
        add("jewellery", "silver_jewellery")
        add("attack_range", "weapon_type", "type", "light_source")
        add("prayer_xp", "book", "event")
        add("empty", "excess", "full")
        add("god", "combo")
        add("tanning")
        add("special", "special_energy", "special_accuracy_mod", "special_damage_mod_1", "special_damage_mod_2", "ammo_required", "cast")
        add("farming_patch", "farming_crop", "farming_amount", "farming_level", "farming_chance", "farming_xp", "compostable", "super_compost", "farming_protect_id", "farming_protect_amount")
        // Official
        add("stab_attack", 0)
        add("slash_attack", 1)
        add("crush_attack", 2)
        add("magic_attack", 3)
        add("range_attack", 4)
        add("stab_defence", 5)
        add("slash_defence", 6)
        add("crush_defence", 7)
        add("magic_defence", 8)
        add("range_defence", 9)
        add("prayer_bonus", 11)
        add("attack_speed", 14)
        add("ammo_group", 21)
        add("secondary_use_level", 23)
        add("unbankable", 59)
        add("quest_list_enum", 61)
        add("world_map_marker_sprite_icon", 130)
        add("world_map_marker_sprite", 131)
        add("world_map_marker_sprite_horizontal", 134)
        add("world_map_marker_sprite_diagonal", 135)
        add("quest_list_interface", 152)
        add("quest_list_scroll", 153)
        add("construction_required_item_id_1", 211)
        add("construction_required_item_amount_1", 212)
        add("construction_required_item_id_2", 213)
        add("construction_required_item_amount_2", 214)
        add("construction_required_item_id_3", 215)
        add("construction_required_item_amount_3", 216)
        add("construction_required_item_id_4", 217)
        add("construction_required_item_amount_4", 218)
        add("construction_required_item_id_5", 219)
        add("construction_required_item_amount_5", 220)
        add("construction_required_item_id_6", 221)
        add("construction_required_item_amount_6", 222)
        add("construction_item", 226)
        add("elite_clue_scroll", 235)
        add("elite_clue_scroll_next", 236)
        add("god_arrow", 237)
        add("skill_cape", 258)
        add("trimmed_skill_cape", 259)
        add("skillcape_skill", 277)
        add("spellbook_root_interface", 316)
        add("mobilising_armies_attackable_obj", 351)
        add("mobilising_armies_collectable_obj", 352)
        add("gravestone_time", 356)
        add("summoning_beast_of_burden_capacity", 379)
        add("summoning_pouch_level", 394)
        add("summoning_defence", 417)
        add("summoning_time_minutes", 424)
        add("shard_refund_amount", 457)
        add("mini_map_icon_category", 477)
        add("mini_map_icon_is_f2p", 478)
        add("worn_option_1", 528)
        add("worn_option_2", 529)
        add("worn_option_3", 530)
        add("worn_option_4", 531)
        add("summoning_pouch_id", 538)
        add("summoning_pouch_amount", 539)
        add("summoning_shard_id", 540)
        add("summoning_shard_amount", 541)
        add("summoning_charm_id", 542)
        add("summoning_charm_amount", 543)
        add("clan_wars_arena_name", 555)
        add("clan_wars_arena_description", 556)
        add("clan_wars_arena_members", 557)
        add("clan_wars_viewing_orb_struct", 580)
        add("clan_wars_viewing_orb_model", 581)
        add("clan_wars_viewing_orb_animation", 582)
        add("clan_wars_viewing_orb_distance", 583)
        add("clan_wars_viewing_orb_rotate_x", 584)
        add("clan_wars_viewing_orb_rotate_y", 585)
        add("clan_wars_viewing_orb_rotate_z", 586)
        add("clan_wars_viewing_orb_position_y", 587)
        add("mini_map_icon_sprite", 595)
        add("mini_map_icon_name", 596)
        add("mini_map_icon_children_count", 597)
        add("summoning_refund_amount_inverse", 599)
        add("equip_type_hide_hair", 624)
        add("equip_type_hat", 625)
        add("strength", 641)
        add("ranged_strength", 643)
        add("render_emote", 644)
        add("spellbook_y", 654)
        add("spellbook_x", 655)
        add("spellbook_offset_y_1", 656)
        add("spellbook_offset_x_1", 657)
        add("spellbook_offset_x_2", 658)
        add("spellbook_offset_y_2", 659)
        add("spellbook_line_length", 660)
        add("spellbook_tooltip_interface", 661)
        add("spellbook_filter_enum", 662)
        add("spellbook_sort_enum", 663)
        add("spellbook_sort_index_enum", 664)
        add("spellbook_sort_option_enum", 665)
        add("quest_list_title", 670)
        add("quest_list_overlay_interface", 671)
        add("quest_list_sorted_title_enum", 673)
        add("quest_list_sorted_title_index_enum", 675)
        add("quest_list_check_empty_enum", 676)
        add("quest_stages_2", 677)
        add("quest_stages_4", 678)
        add("graphics_options_applicable", 682)
        add("graphics_options_drop_down_enum", 683)
        add("spellbook_scroll_interface", 684)
        add("magic_damage", 685)
        add("weapon_style", 686)
        add("special_attack", 687)
        add("spellbook_spell_inv_interface", 688)
        add("hand_cannon_warning", 690)
        add("quest_start_npc", 691)
        add("quest_param_692", 693)
        add("quest_journal_hints", 694)
        add("quest_param_695", 695)
        add("quest_param_696", 696)
        add("summoning_pouch_req_item_id_1", 697)
        add("summoning_pouch_req_item_amount_1", 698)
        add("summoning_pouch_req_item_id_2", 699)
        add("summoning_pouch_req_item_amount_2", 700)
        add("prayer_description", 734)
        add("prayer_sprite_active", 735)
        add("prayer_sprite_inactive", 736)
        add("prayer_required_level", 737)
        add("prayer_requirement_text", 738)
        add("prayer_is_members", 739)
        add("unlit_bug_lantern", 740)
        add("quest_item_type", 741)
        add("recipe_for_disaster_save_count", 742)
        add("quest_requirement_slot_id", 743)
        add("equip_skill_1", 749)
        add("equip_level_1", 750)
        add("equip_skill_2", 751)
        add("equip_level_2", 752)
        add("equip_skill_3", 753)
        add("equip_level_3", 754)
        add("equip_skill_4", 755)
        add("equip_level_4", 756)
        add("equip_skill_5", 757)
        add("equip_level_5", 758)
        add("equip_skill_6", 759)
        add("equip_level_6", 760)
        add("required_combat", 761)
        add("required_quest_id_1", 762)
        add("required_quest_id_2", 764)
        add("required_quest_id_3", 765)
        add("use_skill_1", 770)
        add("use_level_1", 771)
        add("use_skill_2", 772)
        add("use_level_2", 773)
        add("use_skill_3", 774)
        add("use_level_3", 775)
        add("use_skill_4", 776)
        add("use_level_4", 777)
        add("use_skill_5", 778)
        add("use_level_5", 779)
        add("use_skill_6", 780)
        add("use_level_6", 781)
        add("quest_sort_category", 782)
        add("body_look_id", 788)
        add("body_look_index", 789)
        add("body_look_flat_low", 790)
        add("body_look_flat_mid", 791)
        add("body_look_name", 792)
        add("mobilising_armies_cave", 799)
        add("mobilising_armies_fissure", 800)
        add("mobilising_armies_rescued", 801)
        add("mobilising_armies_squad", 802)
        add("mobilising_armies_squad_defeated", 803)
        add("mobilising_armies_squad_type", 805)
        add("mobilising_armies_squad_heavy", 806)
        add("mobilising_armies_squad_defeated_id", 811)
        add("book_item", 813)
        add("mobilising_armies_squad_original_id", 814)
        add("mobilising_armies_reward_credits_cost", 821)
        add("bug_lantern", 823)
        add("interface_text", 845)
        add("interface_text_sortable", 846)
        add("quest_id", 847)
        add("quest_stages_3", 848)
        add("quest_param_850", 850)
        add("quest_param_851", 851)
        add("quest_param_853", 853)
        add("quest_param_854", 854)
        add("quest_param_855", 855)
        add("quest_stages_1", 856)
        add("quest_stage_1", 859)
        add("quest_stage_2", 860)
        add("quest_stage_3", 861)
        add("quest_stage_4", 862)
        add("quest_stage_5", 863)
        add("quest_stage_6", 864)
        add("quest_stage_7", 865)
        add("quest_stage_8", 866)
        add("quest_stage_9", 867)
        add("quest_stage_10", 868)
        add("quest_stage_11", 869)
        add("quest_stage_12", 870)
        add("quest_skill_1", 871)
        add("quest_level_1", 872)
        add("quest_skill_2", 873)
        add("quest_level_2", 874)
        add("quest_skill_3", 875)
        add("quest_level_3", 876)
        add("quest_skill_4", 877)
        add("quest_level_4", 878)
        add("quest_skill_5", 879)
        add("quest_level_5", 880)
        add("quest_skill_6", 881)
        add("quest_level_6", 882)
        add("quest_skill_7", 883)
        add("quest_level_7", 884)
        add("quest_skill_8", 885)
        add("quest_level_8", 886)
        add("quest_skill_9", 887)
        add("quest_level_9", 888)
        add("quest_skill_10", 889)
        add("quest_level_10", 890)
        add("quest_skill_11", 891)
        add("quest_level_11", 892)
        add("quest_skill_12", 893)
        add("quest_level_12", 894)
        add("quest_points_required", 895)
        add("quest_combat_level_req", 896)
        add("quest_att_str_req", 897)
        add("quest_param_898", 898)
        add("book_quest", 923)
        add("book_name", 924)
        add("book_description", 925)
        add("npc_contact_name", 935)
        add("npc_contact_model_locked", 936)
        add("npc_contact_rotation", 937)
        add("npc_contact_model", 938)
        add("npc_contact_anim", 939)
        add("npc_contact_override", 940)
        add("npc_contact_while_guthix_sleeps_text", 941)
        add("npc_contact_while_guthix_sleeps_model", 942)
        add("npc_contact_while_guthix_sleeps_rotation", 943)
        add("npc_contact_while_guthix_sleeps_animation", 944)
        add("quest_start_point_text", 948)
        add("quest_required_items_text", 949)
        add("quest_combat_text", 950)
        add("quest_reward_text", 951)
        add("task_quest_sprite", 952)
        add("barbarian_assault_reward", 954)
        add("barbarian_assault_ticket_wave", 955)
        add("familiarisation_familiar_1", 956)
        add("familiarisation_familiar_2", 957)
        add("familiarisation_type", 958)
        add("magic_strength", 965)
        add("absorb_melee", 967)
        add("absorb_range", 968)
        add("absorb_magic", 969)
        add("infinite_air_runes", 972)
        add("infinite_water_runes", 973)
        add("infinite_earth_runes", 974)
        add("infinite_fire_runes", 975)
        add("dungeoneering_shop_multiplier", 1046)
        add("dungeoneering", 1047)
        add("dungeoneering_bound_item", 1050)
        add("dungeoneering_bound_ammo", 1051)
        add("dungeoneering_reward_item", 1070)
        add("dungeoneering_reward_level", 1071)
        add("dungeoneering_reward_tokens", 1072)
        add("dungeoneering_reward_skill_1", 1073)
        add("dungeoneering_reward_level_1", 1074)
        add("dungeoneering_reward_skill_2", 1075)
        add("dungeoneering_reward_level_2", 1076)
        add("dungeoneering_reward_level_req_text", 1077)
        add("dungeoneering_reward_description", 1078)
        add("dungeoneering_class_name", 1089)
        add("dungeoneering_class_description", 1090)
        add("god_bow_id", 1091)
        add("god_bow_amount", 1092)
        add("conquest_unit_movement", 1134)
        add("conquest_unit_damage", 1135)
        add("conquest_unit_health", 1136)
        add("conquest_unit_range", 1137)
        add("conquest_unit_cost", 1138)
        add("conquest_unit_name", 1139)
        add("conquest_unit_character", 1140)
        add("conquest_param_8", 1141)
        add("conquest_self_command_anim", 1142)
        add("conquest_param_9", 1143)
        add("conquest_param_10", 1144)
        add("conquest_param_11", 1145)
        add("conquest_synth", 1146)
        add("conquest_param_13", 1147)
        add("conquest_unit_sprite", 1148)
        add("conquest_command_index", 1149)
        add("conquest_command_name", 1150)
        add("conquest_command_description", 1151)
        add("conquest_command_description_active", 1152)
        add("conquest_command_sprite", 1153)
        add("conquest_command_points", 1154)
        add("conquest_command_cooldown", 1155)
        add("conquest_command_gfx", 1156)
        add("conquest_command_cursor", 1157)
        add("construction_floor_1", 1158)
        add("construction_floor_2", 1159)
        add("character_creation_style_name", 1160)
        add("character_creation_style_sprite_male", 1161)
        add("character_creation_style_sprite_female", 1162)
        add("character_creation_style_inventory", 1163)
        add("character_creation_style_animation_male", 1164)
        add("character_creation_style_animation_female", 1165)
        add("character_creation_style_model", 1166)
        add("character_creation_style_background_animation_male", 1167)
        add("character_creation_style_background_animation_female", 1168)
        add("character_creation_sub_style_male_0", 1169)
        add("character_creation_sub_style_male_1", 1170)
        add("character_creation_sub_style_male_2", 1171)
        add("character_creation_sub_style_male_3", 1172)
        add("character_creation_sub_style_male_4", 1173)
        add("character_creation_sub_style_male_5", 1174)
        add("character_creation_sub_style_female_0", 1175)
        add("character_creation_sub_style_female_1", 1176)
        add("character_creation_sub_style_female_2", 1177)
        add("character_creation_sub_style_female_3", 1178)
        add("character_creation_sub_style_female_4", 1179)
        add("character_creation_sub_style_female_5", 1180)
        add("character_creation_sub_style_sprite", 1181)
        add("character_style_top", 1182)
        add("character_style_arms", 1183)
        add("character_style_wrists", 1184)
        add("character_style_legs", 1185)
        add("character_style_shoes", 1186)
        add("character_style_colour_top_0", 1187)
        add("character_style_colour_legs_0", 1188)
        add("character_style_colour_shoes_0", 1189)
        add("character_style_colour_top_1", 1190)
        add("character_style_colour_legs_1", 1191)
        add("character_style_colour_shoes_1", 1192)
        add("character_style_colour_top_2", 1193)
        add("character_style_colour_legs_2", 1194)
        add("character_style_colour_shoes_2", 1195)
        add("character_style_colour_top_3", 1196)
        add("character_style_colour_legs_3", 1197)
        add("character_style_colour_shoes_3", 1198)
        add("character_style_colour_top_4", 1199)
        add("character_style_colour_legs_4", 1200)
        add("character_style_colour_shoes_4", 1201)
        add("character_style_colour_top_5", 1202)
        add("character_style_colour_legs_5", 1203)
        add("character_style_colour_shoes_5", 1204)
        add("character_style_colour_top_6", 1205)
        add("character_style_colour_legs_6", 1206)
        add("character_style_colour_shoes_6", 1207)
        add("character_style_colour_top_7", 1208)
        add("character_style_colour_legs_7", 1209)
        add("character_style_colour_shoes_7", 1210)
        add("worn_option_5", 1211)
        add("quest_reward_text_1", 1212)
        add("void_stares_back_key_block_label", 1225)
        add("void_stares_back_key_block_weight", 1226)
        add("conquest_unit_param_15", 1229)
        add("conquest_unit_param_16", 1230)
        add("dynamic_inventory_option_original", 1264)
        add("dynamic_inventory_option_replacement", 1265)
        add("task_name", 1266)
        add("task_area", 1267)
        add("task_index", 1268)
        add("task_next_index", 1269)
        add("task_quest_id", 1270)
        add("task_sprite", 1271)
        add("task_difficulty", 1272)
        add("task_description", 1273)
        add("task_hint_1", 1274)
        add("task_hint_2", 1275)
        add("task_hint_3", 1276)
        add("task_hint_4", 1277)
        add("task_hint_5", 1278)
        add("task_hint_6", 1279)
        add("task_text_rol", 1280)
        add("task_hint_tile_1", 1282)
        add("task_hint_tile_2", 1283)
        add("task_hint_tile_3", 1284)
        add("task_hint_tile_4", 1285)
        add("task_hint_tile_5", 1286)
        add("task_hint_tile_6", 1287)
        add("task_members", 1290)
        add("task_set", 1292)
        add("task_sprite_offset", 1293)
        add("task_skill_1", 1294)
        add("task_level_1", 1295)
        add("task_skill_2", 1296)
        add("task_level_2", 1297)
        add("task_skill_3", 1298)
        add("task_level_3", 1299)
        add("task_skill_4", 1300)
        add("task_level_4", 1301)
        add("task_skill_5", 1302)
        add("task_level_5", 1303)
        add("task_skill_6", 1304)
        add("task_level_6", 1305)
        add("task_skill_7", 1306)
        add("task_level_7", 1307)
        add("task_skill_8", 1308)
        add("task_level_8", 1309)
        add("task_skill_9", 1310)
        add("task_level_9", 1311)
        add("task_skill_10", 1312)
        add("task_level_10", 1313)
        add("task_is_tutorial", 1322)
        add("summoning_beast_of_burden", 1323)
        add("required_chompy_kills", 1366)
        add("chompy_hat_name", 1367)
        add("chompy_hat_desc", 1368)
        add("stage_on_death", 1397)
        add("shadow", 1912)
        add("linked_shadow_npc", 2098)
        add("category", 2195)
        add("param_723", 723)
        val list = listOf("smithing", "light_source", "fletching_unf", "cleaning", "fishing", "skill_req", "cooking", "mining", "fletch_bolts", "smelting", "jewellery", "pottery", "weaving", "spinning", "spinning", "silver_jewellery", "runecrafting", "fletch_dart", "firemaking")
        for (name in list) {
            convertBinary(
                name,
                decode = { mapOf("string" to (it as String)) },
                encode = { (it as Map<*, *>).toString() }
            )
        }
    }

    override fun loaded(types: Array<ItemType?>) {
        var index = 0
        for (type in types) {
            type ?: continue
            if (type.equipIndex > 0) {
                type.equipIndex = index++
            }
            if (type.notedTemplateId != -1) {
                types[type.id] = type.toNote(types[type.notedTemplateId], types[type.noteId]) ?: continue
            }
            if (type.lendTemplateId != -1) {
                types[type.id] = type.toLend(types[type.lendId], types[type.lendTemplateId]) ?: continue
            }
        }
    }

    override val active = setOf(name, stackable, cost, members, primaryMaleModel, primaryFemaleModel, floorOptions, options, exchangeable, dummyItem, noteId, notedTemplateId, lendId, lendTemplateId, stringId, parameters)

    override fun create(index: Int): ItemType {
        val equipIndex = if (primaryFemaleModel.get(index) >= 0) 2 else if (primaryMaleModel.get(index) >= 0) 1 else -1
        return ItemType(
            id = index,
            name = name.get(index),
            stackable = stackable.get(index),
            cost = cost.get(index),
            members = members.get(index),
            floorOptions = floorOptions.get(index),
            options = options.get(index),
            exchangeable = exchangeable.get(index),
            dummyItem = dummyItem.get(index),
            noteId = noteId.get(index).toInt(),
            notedTemplateId = notedTemplateId.get(index).toInt(),
            lendId = lendId.get(index).toInt(),
            lendTemplateId = lendTemplateId.get(index).toInt(),
            stringId = stringId.get(index),
            equipIndex = equipIndex,
            params = parameters.get(index),
        )
    }

    override fun load(type: ItemType) {
        val index = type.id
        name.set(index, type.name)
        stackable.set(index, type.stackable)
        cost.set(index, type.cost)
        members.set(index, type.members)
        floorOptions.set(index, type.floorOptions)
        options.set(index, type.options)
        exchangeable.set(index, type.exchangeable)
        dummyItem.set(index, type.dummyItem)
        noteId.set(index, type.noteId.toShort())
        notedTemplateId.set(index, type.notedTemplateId.toShort())
        lendId.set(index, type.lendId.toShort())
        lendTemplateId.set(index, type.lendTemplateId.toShort())
        stringId.set(index, type.stringId)
        parameters.set(index, type.params?.toMutableMap())
    }
}