[has_axe]
requirements = [
    { type = "carries", preset = "axe" },
    { type = "inventory_space", amount = 20 },
]

[bank_all_after_full]
plan = [
    { action = "wait_for_full_inv" },
    { action = "go_to", target = "bank" },
    { action = "interact_npc", option = "Bank", id = "banker*" },
    { action = "interface", option = "Deposit-All", id = "bank:inventory" },
]

[regular_trees]
type = "activity"
capacity = 4
requirements = [
    { clone = "has_axe" },
    { type = "skill", id = "woodcutting", min = 1, max = 15 },
]
plan = [
    { action = "go_to", target = "tree_area" },
    { action = "interact_obj", option = "Chop-down", id = "tree*" },
    { clone = "bank_all_after_full" },
]
produces = [
    { item = "logs" }
]



[actions.open_varrock_bank]
requires = [
    { location = "varrock_bank" }
]
action = { option = "Open-bank", npc = "varrock_banker" }
effect = [
    { interface = "bank" }
]

[axe_shopping]
requirements = [
    { type = "inventory_space", amount = 1 },
]
plan = [
    { action = "go_to", target = "axe_store" },
    { action = "interact_npc", option = "Trade", id = "axe_store_owner" },
]

[buy_bronze_axe]
type = "resolver"
requirements = [
    { type = "skill", id = "woodcutting", min = 5 },
    { type = "holds", id = "coins", amount = 25 },
    { clone = "axe_shopping" },
]
plan = [
    { clone = "axe_shopping" },
    { action = "interface", option = "Buy-1", id = "axe_shop:inventory" },
]
produces = [
    { item = "bronze_axe" }
]

[buy_iron_axe]
type = "resolver"
requirements = [
    { type = "skill", id = "woodcutting", min = 10 },
    { type = "carries", id = "coins", amount = 150 },
    { clone = "axe_shopping" },
]
plan = [
    { clone = "axe_shopping" },
    { action = "interface", option = "Buy-1", id = "axe_shop:inventory:iron_axe" },
]
produces = [
    { item = "iron_axe" }
]

# equips -> equipped
# carries -> on person
# owns -> in bank or on person

[ring_of_duelling_equipped]
type = "teleport"
weight = 10
requirements = [
    { type = "variable", id = "spellbook", value = "normal" },
    { type = "equips", id = "ring_of_dueling_*" }
]
plan = [
    { action = "interface", option = "Castle Wars", id = "equipment:inventory" },
]
produces = [
    { location = "castle_wars_teleport" }
]

[ring_of_duelling]
type = "teleport"
weight = 10
requirements = [
    { type = "variable", id = "spellbook", value = "normal" },
    { type = "in_inventory", id = "ring_of_dueling_*" }
]
plan = [
    { action = "interface", option = "Rub", id = "inventory:inventory" },
    { action = "interface", option = "Select", id = "choice:line1" },
]
produces = [
    { location = "castle_wars_teleport" }
]


[teleport_varrock]
type = "teleport"
weight = 10
requirements = [
    { type = "variable", id = "spellbook", value = "normal" },
    { type = "carries", id = "fire_rune", amount = 1 },
    { type = "carries", id = "air_rune", amount = 3 },
    { type = "carries", id = "law_rune", amount = 1 },
]
plan = [
    { action = "interface", option = "Cast", id = "normal_spellbook:varrock_teleport" },
]
produces = [
    { location = "varrock_teleport" }
]

[teleport_lumbridge]
type = "teleport"
weight = 0
requirements = [
    { type = "variable", id = "spellbook", value = "normal" },
    { type = "variable", id = "lumbridge_cooldown", value = "normal" },
]
plan = [
    { action = "interface", option = "Cast", id = "normal_spellbook:home_teleport" },
]
produces = [
    { location = "lumbridge_teleport" }
]

[go_to_bank]
req = ["inventory_full"]
action = { type = "go_to", target = "bank" }
context = "banking"

[bank_all]
req = ["in_bank", "items_in_inventory"]
action = { type = "interact_npc", option = "Open bank", target = "banker*" }
context = "bank_open"

[withdraw_coins]
req = ["coins_in_bank", "bank_open"]
action = { type = "interface", option = "Withdraw-100", target = "coins" }
context = "shopping"

[go_to_axe_shop]
req = ["shopping", "1_inventory_space"]
context = "axe_shopping"

[open_axe_shop]
req = ["axe_shopping"]
action = { type = "interact_npc", option = "Trade", target = "axe_shopkeeper" }
context = "axe_shop"

[buy_axe_shop]
req = ["axe_shop"]
action = { type = "interact_npc", option = "Buy", target = "iron_axe" }
context = "axe"

[buy_pickaxe_shop]
req = ["axe_shop"]
action = { type = "interact_npc", option = "Buy", target = "iron_pickaxe" }
context = "pickaxe"


[bank_deposit_items]
req = ["inventory_full"]
context = "banking"

[bank_withdraw_items]
req = ["inventory_empty"]
context = "banking"

[bank_withdraw_melee_gear]
req = [
    { context = "banking" },
]
context = "melee_combat"

[bank_withdraw_mage_gear]
req = [
    { context = "banking" },
]
context = "magic_combat"

[fight_cows]
req = [
    { context = "melee_combat" },
    { skill = "attack", min = 5 },
]

[fight_chickens]
req = [
    { context = "melee_combat" },
    { skill = "attack", min = 1 },
]
context = "fight_chickens"

# val context = Stack<String>() // after complete pop and re-evaluate

[bank_withdraw_ranged]
req = ["inventory_empty"]













[woodcutting]
requires = { state = "idle" }
states = [
    { to = "find_tree" },
    { to = "buy_axe" },
    { to = "get_axe" },
    { to = "wait" },
]

[woodcutting.get_axe]
actions = [
    { go_to = "jims_farm" },
    { option = "Pick-up", item = "iron_axe" },
]

[woodcutting.buy_axe]
requires = [
    { carries = "coins", amount = 10 }
]
actions = [
    { go_to = "axe_store" },
    { option = "Trade", npc = "axe_store_owner" },
    { option = "Buy-1", interface = "shop:inventory:iron_axe" },
]

[woodcutting.find_tree]
requires = [
    { carries = "iron_axe" }
]
actions = [
    { go_to = "village_woods" },
    { option = "Chop-down", obj = "normal_tree" },
]



[walk_to_bank_trees]
actions = [
    { go_to = "nearest_bank" }
]
transitions = [
    { when = { in = "bank" }, then = "open_bank_trees" },
    { when = { timeout = 20 }, then = "idle" }
]

[open_bank_trees]
actions = [
    { go_to = "nearest_bank" }
]
transitions = [
    { when = { in = "bank" }, then = "open_bank_logs" },
    { when = { timeout = 20 }, then = "idle" }
]

[open_bank_logs]
actions = [
    { option = "Open-bank", npc = "banker" }
]
transitions = [
    { when = { open = "bank" }, then = "deposit_logs" },
    { when = { timeout = 20 }, then = "idle" }
]

[go_to_trees]
transitions = [
    { when = { in = "tree_area" }, then = "find_tree" },
]

[find_tree]
actions = [
    { scan_for = "tree", radius = 5 }
]
transitions = [
    { when = { has_target = true }, then = "chop_tree" },
    { when = { location_not = "tree_area" }, then = "walk_to_trees" },
    { when = { timeout = 5 }, then = "idle" }
]

[walk_to_trees]
actions = [
    { go_to = "tree_area" }
]
transitions = [
    { when = { in = "tree_area" }, then = "find_tree" },
    { when = { timeout = 20 }, then = "idle" },
]

[chop_tree]
actions = [
    { option = "Chop-down", entity = "target" }
]
transitions = [
    { when = { inventory_full = true }, then = "walk_to_bank_trees" },
    { when = { has_target = false }, then = "find_tree" },
    { when = { timeout = 30 }, then = "idle" }
]
































